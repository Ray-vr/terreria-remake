<!DOCTYPE html>
<html>
<head>
  <title>Terraria-Like Game</title>
  <style>
    body {
      margin: 0;
      background-color: #1e1e1e;
      font-family: 'Courier New', monospace;
      color: white;
      text-align: center;
    }
    #main-menu {
      padding-top: 50px;
    }
    #menu-grid {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .menu-slot {
      background-color: #333;
      border: 2px solid #888;
      padding: 20px;
      cursor: pointer;
      font-size: 16px;
      color: #fff;
      box-shadow: inset 0 0 5px #000;
    }
    .menu-slot:hover {
      background-color: #555;
    }
    .trash {
      background-color: #800;
    }
    canvas {
      display: block;
      margin: auto;
      background-color: #87CEEB;
    }
    #inventory {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border: 1px solid #fff;
      display: grid;
      grid-template-columns: repeat(5, 40px);
      gap: 5px;
    }
    #inventory div {
      width: 40px;
      height: 40px;
      background: #333;
      border: 1px solid #999;
      text-align: center;
      line-height: 40px;
    }
  </style>
</head>
<body>
  <div id="main-menu">
    <h1>üå≤ Terraria-Like Adventure</h1>
    <div id="menu-grid">
      <div class="menu-slot" onclick="startGame()">‚ñ∂ Play</div>
      <div class="menu-slot" onclick="toggleSettings()">‚öô Settings</div>
      <div class="menu-slot" onclick="exitGame()">‚ùå Exit</div>
      <div class="menu-slot trash" onclick="clearSettings()">üóë</div>
    </div>
    <div id="settings" style="display:none;">
      <h2>Controls</h2>
      <ul>
        <li>Arrow Keys: Move</li>
        <li>Spacebar: Jump</li>
        <li>Click: Place/Remove Block</li>
      </ul>
      <h2>Player Color</h2>
      <input type="color" id="playerColor" value="#0000ff" onchange="updatePlayerColor()" />
      <p>Page 1 of 4</p>
    </div>
  </div>

  <canvas id="game" width="800" height="600" style="display:none;"></canvas>
  <div id="inventory" style="display:none;"></div>
  <button onclick="saveGame()" style="display:none;" id="saveBtn">Save</button>
  <button onclick="loadGame()" style="display:none;" id="loadBtn">Load</button>

  <script>
    window.onload = function() {
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      const tileSize = 40;
      const worldWidth = 200;
      const worldHeight = 40;
      let cameraX = 0;
      let playerColor = "#0000ff";

      const BIOMES = ["forest", "desert", "jungle", "underworld"];
      const BIOME_COLORS = {
        forest: "#228B22",
        desert: "#DEB887",
        jungle: "#006400",
        underworld: "#4B0082",
        dirt: "#654321"
      };

      let world = Array.from({ length: worldHeight }, () => Array(worldWidth).fill(0));
      for (let x = 0; x < worldWidth; x++) {
        let biome = BIOMES[Math.floor(x / (worldWidth / BIOMES.length))];
        for (let y = worldHeight / 2; y < worldHeight; y++) {
          world[y][x] = biome;
        }
      }

      for (let i = 0; i < 5; i++) {
        let ix = Math.floor(Math.random() * worldWidth);
        let iy = Math.floor(Math.random() * worldHeight / 2);
        for (let y = -1; y <= 1; y++) {
          for (let x = -2; x <= 2; x++) {
            if (world[iy + y] && world[iy + y][ix + x] !== undefined) {
              world[iy + y][ix + x] = "dirt";
            }
          }
        }
      }

      let player = {
        x: 10,
        y: 10,
        vx: 0,
        vy: 0,
        width: 1,
        height: 1,
        grounded: false,
        hunger: 100,
        class: "melee"
      };

      let inventory = { wood: 0, stone: 0, torch: 0 };
      let stations = [{ name: "Work Bench", x: 20, y: worldHeight / 2 - 1 }];
      let npcs = [{ name: "Guide", x: 15, y: worldHeight / 2 - 1, service: "tips" }];

      let time = 0;
      let isNight = false;
      let isRaining = false;
      let survivalMode = true;

      function updateTime() {
        time += 0.01;
        if (time >= 24) time = 0;
        isNight = time >= 18 || time < 6;
        isRaining = Math.random() < 0.001;
        if (survivalMode) {
          player.hunger -= 0.01;
          if (player.hunger <= 0) alert("You starved!");
        }
      }

      function drawWorld() {
        for (let y = 0; y < worldHeight; y++) {
          for (let x = 0; x < worldWidth; x++) {
            let tile = world[y][x];
            if (tile) {
              ctx.fillStyle = BIOME_COLORS[tile] || "#000";
              ctx.fillRect((x - cameraX) * tileSize, y * tileSize, tileSize, tileSize);
            }
          }
        }
      }

      function drawPlayer() {
        ctx.fillStyle = playerColor;
        ctx.fillRect((player.x - cameraX) * tileSize, player.y * tileSize, tileSize, tileSize);
      }

      function drawStations() {
        stations.forEach(station => {
          ctx.fillStyle = "#ccc";
          ctx.fillRect((station.x - cameraX) * tileSize, station.y * tileSize, tileSize, tileSize);
        });
      }

      function drawNPCs() {
        npcs.forEach(npc => {
          ctx.fillStyle = "#ff0";
          ctx.fillRect((npc.x - cameraX) * tileSize, npc.y * tileSize, tileSize, tileSize);
        });
      }

      function updateInventoryUI() {
        const inv = document.getElementById("inventory");
        inv.innerHTML = "";
        Object.keys(inventory).forEach(item => {
          const slot = document.createElement("div");
          slot.textContent = inventory[item] > 0 ? `${item[0].toUpperCase()}:${inventory[item]}` : "";
          inv.appendChild(slot);
        });
      }

      function updatePhysics() {
        player.vy += 0.5;
        player.x += player.vx;
        player.y += player.vy;

        player.grounded = false;
        for (let y = Math.floor(player.y); y < Math.ceil(player.y + player.height); y++) {
          for (let x = Math.floor(player.x); x < Math.ceil(player.x + player.width); x++) {
            if (world[y] && world[y][x]) {
              if (player.vy > 0) {
                player.y = y - player.height;
                player.vy = 0;
                player.grounded = true;
              } else if (player.vy < 0) {
                player.y = y + 1;
                player.vy = 0;
              }
            }
          }
        }

        player.x = Math.max(0, Math.min(worldWidth - player.width, player.x));
        player.y = Math.min(worldHeight - player.height, player.y);
        cameraX = Math.floor(player.x - canvas.width / tileSize / 2);
        cameraX = Math.max(0, Math.min(worldWidth - canvas.width / tileSize, cameraX));
      }

      function render() {
        ctx.clear
